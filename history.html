<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>NotGoogleMaps ‚Äî Saved Routes History</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background: #f4f6f9;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      padding: 20px;
    }
    h1 {
      color: #ff5f6d;
      text-align: center;
      margin-bottom: 20px;
    }
    table {
      background: white;
      border-radius: 8px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    }
    .btn-load {
      background: #ffc371;
      border: none;
      color: #333;
    }
    .btn-load:hover {
      background: #ffb84d;
    }
    .btn-delete {
      background: #ff5f6d;
      border: none;
      color: white;
    }
    .btn-delete:hover {
      background: #e14c59;
    }
    #noRoutes {
      text-align: center;
      margin-top: 30px;
      color: #666;
    }
    body.theme-dark {
  background: #121212;
  color: #ddd;
}
body.theme-dark header {
  background-color: rgba(30, 30, 30, 0.95);
  border-bottom: 4px dashed #ff66cc;
  color: #eee;
}
body.theme-dark .badge {
  background-color: rgba(50, 50, 50, 0.9);
  box-shadow: 0 4px 10px rgba(255, 255, 255, 0.1);
  border-color: #ff66cc;
  color: #eee;
}
body.theme-dark .unlock-btn {
  background: #cc99ff;
  color: #111;
}
body.theme-dark .unlock-btn:hover {
  background: #b377ff;
}
body.theme-dark .self-destruct-btn {
  background: #ff6666;
  color: #111;
}
body.theme-dark .self-destruct-btn:hover {
  background: #cc3333;
}
body.theme-dark #loadingBar {
  background: #cc99ff;
}

  </style>
</head>
<body>

  <h1>üöó NotGoogleMaps ‚Äî Saved Routes History</h1>
  <nav class="navbar navbar-light bg-light mb-3">
  <div class="container">
    <a class="navbar-brand" href="index.html">WrongMaps</a>
    <a href="history.html" class="btn btn-outline-secondary btn-sm">Saved Routes</a>
  </div>
</nav>

  <div class="container">
    <table class="table table-hover" id="routesTable">
      <thead>
        <tr>
          <th>#</th>
          <th>Start (Lat,Lng)</th>
          <th>Prank Destination (Lat,Lng)</th>
          <th>Travel Mode</th>
          <th>Saved On</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="routesBody"></tbody>
    </table>
    <div id="noRoutes">No saved prank routes found.</div>
  </div>
  <div class="container mt-2 text-start">
  <a href="index.html" class="btn btn-outline-primary btn-sm">üè† Back to Map</a>
</div>


  <script>
    // Load saved routes from localStorage
    const routesKey = 'wrongmapsSavedRoutes';
    const routesTableBody = document.getElementById('routesBody');
    const noRoutesDiv = document.getElementById('noRoutes');

    function formatDateTime(ts) {
      const d = new Date(ts);
      return d.toLocaleString();
    }

    function loadRoutes() {
      const routes = JSON.parse(localStorage.getItem(routesKey)) || [];
      routesTableBody.innerHTML = '';

      if (routes.length === 0) {
        noRoutesDiv.style.display = 'block';
        return;
      }
      noRoutesDiv.style.display = 'none';

      routes.forEach((route, i) => {
        const row = document.createElement('tr');

        row.innerHTML = `
          <td>${i + 1}</td>
          <td>${route.start[0].toFixed(5)}, ${route.start[1].toFixed(5)}</td>
          <td>${route.destination[0].toFixed(5)}, ${route.destination[1].toFixed(5)}</td>
          <td>${route.mode}</td>
          <td>${formatDateTime(route.timestamp)}</td>
          <td>
            <button class="btn btn-sm btn-load" data-index="${i}">Load</button>
            <button class="btn btn-sm btn-delete" data-index="${i}">Delete</button>
          </td>
        `;
        routesTableBody.appendChild(row);
      });

      // Attach event listeners for buttons
      document.querySelectorAll('.btn-load').forEach(btn => {
        btn.addEventListener('click', () => {
          const idx = btn.getAttribute('data-index');
          loadRoute(idx);
        });
      });

      document.querySelectorAll('.btn-delete').forEach(btn => {
        btn.addEventListener('click', () => {
          const idx = btn.getAttribute('data-index');
          deleteRoute(idx);
        });
      });
    }

    function loadRoute(index) {
      const routes = JSON.parse(localStorage.getItem(routesKey)) || [];
      if (!routes[index]) return alert('Route not found.');

      const route = routes[index];

      // Save route to sessionStorage so main map page can read it
      sessionStorage.setItem('routeToLoad', JSON.stringify(route));
      alert('Route saved! You will be redirected to the map.');

      // Redirect to main map page
      window.location.href = 'index.html';
    }

    function deleteRoute(index) {
      const routes = JSON.parse(localStorage.getItem(routesKey)) || [];
      if (!routes[index]) return;

      if (confirm('Are you sure you want to delete this saved route?')) {
        routes.splice(index, 1);
        localStorage.setItem(routesKey, JSON.stringify(routes));
        loadRoutes();
      }
    }

    loadRoutes();
    // Apply saved dark mode setting on page load
(function() {
  const darkModeSetting = localStorage.getItem('darkMode');
  if (darkModeSetting === 'enabled') {
    document.body.classList.add('theme-dark');
  } else {
    document.body.classList.remove('theme-dark');
  }
})();

  </script>
</body>
</html>
